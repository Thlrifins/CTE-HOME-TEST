<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ร้านเจริญธรรมการไฟฟ้าสาขาใหญ่/CTE-HOME - เกมทดสอบ</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    max-width: 700px;
    margin: 20px auto;
    padding: 15px;
    background: #f0f8ff;
  }
  h1 {
    text-align: center;
    color: #004080;
  }
  #start-container, #quiz-container, #result, #history-container {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px #ccc;
    margin-top: 20px;
  }
  #start-container input[type="text"] {
    width: 100%;
    font-size: 18px;
    padding: 10px;
    border: 2px solid #004080;
    border-radius: 5px;
    box-sizing: border-box;
  }
  #start-container button,
  #quiz-container .answers button,
  #result button {
    display: block;
    margin: 12px auto;
    padding: 12px 25px;
    font-size: 18px;
    cursor: pointer;
    border: none;
    border-radius: 6px;
    background-color: #004080;
    color: white;
    transition: background-color 0.3s;
  }
  #start-container button:disabled,
  #quiz-container .answers button:disabled {
    background-color: #999999;
    cursor: not-allowed;
  }
  #start-container button:hover:not(:disabled),
  #quiz-container .answers button:hover:not(:disabled),
  #result button:hover {
    background-color: #0066cc;
  }
  .question {
    font-size: 1.2rem;
    margin-bottom: 15px;
    color: #003366;
  }
  .answers button {
    width: 100%;
    margin: 6px 0;
  }
  .score {
    font-weight: bold;
    font-size: 1.3rem;
    margin-top: 15px;
    text-align: center;
    color: #00264d;
  }
  .explanation {
    margin-top: 10px;
    font-style: italic;
    color: #004080;
    text-align: center;
  }
  .knowledge {
    margin-top: 15px;
    background: #e6f0ff;
    padding: 12px;
    border-radius: 8px;
    color: #003366;
    font-size: 1rem;
    line-height: 1.4;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
  }
  th, td {
    border: 1px solid #004080;
    padding: 8px;
    text-align: center;
    font-size: 0.9rem;
  }
  th {
    background-color: #cce0ff;
    color: #003366;
  }
  @media (max-width: 480px) {
    body {
      margin: 10px;
      padding: 10px;
    }
    h1 {
      font-size: 1.5rem;
    }
    #start-container button,
    #quiz-container .answers button,
    #result button {
      font-size: 16px;
      padding: 10px 20px;
    }
    th, td {
      font-size: 0.8rem;
      padding: 6px;
    }
  }
</style>
</head>
<body>

<h1>ร้านเจริญธรรมการไฟฟ้าสาขาใหญ่/CTE-HOME - เกมทดสอบ</h1>

<div id="history-container">
  <h2 style="color:#004080; text-align:center;">คะแนนย้อนหลังผู้เล่น</h2>
  <div id="history-table">โหลดข้อมูล...</div>
</div>

<div id="start-container">
  <label for="playerName" style="font-size:18px; color:#003366;">กรุณากรอกชื่อเล่นของคุณก่อนเริ่มเกม:</label>
  <input type="text" id="playerName" placeholder="เช่น สมชาย, น้ำฝน" />
  <button id="startBtn" disabled>เริ่มเกม</button>
</div>

<div id="quiz-container" style="display:none;">
  <div id="question" class="question"></div>
  <div id="answers" class="answers"></div>
</div>

<div id="result" style="display:none;"></div>

<script>
const quizData = [
  {
    question: "ร้านเจริญธรรมการไฟฟ้าขายสินค้าประเภทใดเป็นหลัก?",
    answers: [
      { text: "อุปกรณ์ไฟฟ้าและสายไฟ", correct: true },
      { text: "เครื่องใช้ไฟฟ้าในครัวเรือน", correct: false },
      { text: "เฟอร์นิเจอร์ไม้", correct: false },
      { text: "อุปกรณ์คอมพิวเตอร์", correct: false },
    ],
    explanation: "ร้านเน้นจำหน่ายอุปกรณ์ไฟฟ้าและสายไฟคุณภาพดี",
    knowledge: "ร้านเจริญธรรมการไฟฟ้ามุ่งเน้นการจำหน่ายอุปกรณ์ไฟฟ้าและสายไฟที่มีมาตรฐาน เพื่อรองรับความต้องการของลูกค้าและเพิ่มความปลอดภัยในระบบไฟฟ้า."
  },
  {
    question: "สายไฟประเภทใดที่ลูกค้าร้านเจริญธรรมการไฟฟ้าสามารถซื้อไปใช้กับบ้านทั่วไป?",
    answers: [
      { text: "สาย VCT", correct: true },
      { text: "สายเคเบิลไฟฟ้าแรงสูง", correct: false },
      { text: "สายไฟใต้ดิน", correct: false },
      { text: "สายไฟสำหรับโรงงานเท่านั้น", correct: false },
    ],
    explanation: "สาย VCT เป็นสายไฟที่เหมาะสำหรับใช้ในบ้านทั่วไป",
    knowledge: "สาย VCT เป็นสายไฟที่ออกแบบมาสำหรับงานไฟฟ้าในบ้านเรือน มีความยืดหยุ่นและทนทานต่อการใช้งานในสภาพแวดล้อมทั่วไป."
  },
  {
    question: "หากลูกค้าต้องการซื้อเบรกเกอร์เพื่อความปลอดภัย ควรเลือกเบรกเกอร์แบบใด?",
    answers: [
      { text: "เบรกเกอร์ MCCB", correct: false },
      { text: "เบรกเกอร์ MCB", correct: true },
      { text: "ฟิวส์แก้ว", correct: false },
      { text: "เบรกเกอร์อัตโนมัติแรงสูง", correct: false },
    ],
    explanation: "เบรกเกอร์ MCB เหมาะสำหรับบ้านและอาคารขนาดเล็ก",
    knowledge: "เบรกเกอร์ MCB (Miniature Circuit Breaker) ใช้ป้องกันวงจรไฟฟ้าขนาดเล็ก เช่น บ้านพักอาศัย ช่วยตัดไฟเมื่อเกิดไฟฟ้าลัดวงจรหรือกระแสเกิน."
  },
  {
    question: "อุปกรณ์ใดช่วยป้องกันไฟฟ้ารั่ว?",
    answers: [
      { text: "ฟิวส์", correct: false },
      { text: "เบรกเกอร์ MCCB", correct: false },
      { text: "อุปกรณ์ RCD หรือ RCCB", correct: true },
      { text: "สายดิน", correct: false },
    ],
    explanation: "RCD (Residual Current Device) ช่วยตัดวงจรเมื่อไฟฟ้ารั่วไหล",
    knowledge: "RCD หรือ RCCB คืออุปกรณ์ที่ช่วยป้องกันอันตรายจากไฟฟ้ารั่วโดยจะตัดไฟอัตโนมัติเมื่อมีการรั่วไหลของกระแสไฟฟ้า."
  },
  {
    question: "สายไฟที่มีฉนวน PVC สีแดง หมายถึงอะไร?",
    answers: [
      { text: "สายกราวด์", correct: false },
      { text: "สายไฟเฟส (Phase)", correct: true },
      { text: "สายกลาง (Neutral)", correct: false },
      { text: "สายสัญญาณ", correct: false },
    ],
    explanation: "สีแดงมักใช้แทนสายไฟเฟส",
    knowledge: "สายไฟที่มีฉนวนสีแดงหมายถึงสายไฟเฟส ซึ่งเป็นสายที่นำไฟฟ้ามายังโหลด มีความสำคัญในระบบไฟฟ้า AC."
  },
  {
    question: "แรงดันไฟฟ้าที่เหมาะสมสำหรับบ้านทั่วไปในประเทศไทยคือ?",
    answers: [
      { text: "220 โวลต์", correct: true },
      { text: "110 โวลต์", correct: false },
      { text: "380 โวลต์", correct: false },
      { text: "440 โวลต์", correct: false },
    ],
    explanation: "บ้านทั่วไปใช้แรงดันไฟฟ้า 220 โวลต์",
    knowledge: "แรงดันไฟฟ้า 220 โวลต์เป็นมาตรฐานที่ใช้ในบ้านพักอาศัยและอาคารทั่วไปในประเทศไทย เพื่อความปลอดภัยและประสิทธิภาพของเครื่องใช้ไฟฟ้า."
  },
  {
    question: "ประเภทของสายไฟที่ใช้กับอุปกรณ์ไฟฟ้าที่ต้องการความยืดหยุ่นสูงคือ?",
    answers: [
      { text: "สาย VCT", correct: true },
      { text: "สาย THW", correct: false },
      { text: "สาย XLPE", correct: false },
      { text: "สายไฟแรงสูง", correct: false },
    ],
    explanation: "สาย VCT มีความยืดหยุ่นสูง เหมาะกับการเดินสายที่ต้องเคลื่อนย้าย",
    knowledge: "สาย VCT (Vinyl Cabtyre) เป็นสายไฟที่มีความยืดหยุ่นสูง ใช้งานได้ดีในงานที่ต้องเคลื่อนย้ายหรืองานเครื่องมือไฟฟ้า."
  },
  {
    question: "อุปกรณ์ใดช่วยลดความเสี่ยงไฟฟ้าช็อตเมื่อใช้งานเครื่องใช้ไฟฟ้า?",
    answers: [
      { text: "ฟิวส์", correct: false },
      { text: "สายกราวด์ (สายดิน)", correct: true },
      { text: "เบรกเกอร์ MCB", correct: false },
      { text: "สายไฟฟ้าแรงสูง", correct: false },
    ],
    explanation: "สายกราวด์ช่วยนำไฟฟ้ารั่วไปยังดิน ป้องกันไฟฟ้าช็อต",
    knowledge: "สายกราวด์หรือสายดินเป็นสายที่ต่อกับดินเพื่อป้องกันไฟฟ้ารั่วไหลเข้าสู่ร่างกายผู้ใช้ ป้องกันการเกิดไฟฟ้าช็อต."
  },
  {
    question: "ถ้าไฟฟ้าขัดข้องในบ้าน ควรตรวจสอบอุปกรณ์ใดก่อน?",
    answers: [
      { text: "เบรกเกอร์ MCB", correct: true },
      { text: "สายไฟ", correct: false },
      { text: "หลอดไฟ", correct: false },
      { text: "อุปกรณ์ RCD", correct: false },
    ],
    explanation: "เบรกเกอร์ MCB มักจะตัดไฟเมื่อมีปัญหาไฟฟ้า",
    knowledge: "เบรกเกอร์ MCB จะตัดไฟอัตโนมัติเมื่อเกิดไฟฟ้าลัดวงจรหรือโหลดเกิน จึงควรตรวจสอบก่อนอุปกรณ์อื่นๆ."
  },
  {
    question: "ควรเก็บอุปกรณ์ไฟฟ้าอย่างไรเพื่อให้ใช้งานได้นาน?",
    answers: [
      { text: "เก็บในที่แห้งและเย็น", correct: true },
      { text: "เก็บในที่ชื้น", correct: false },
      { text: "วางใกล้เปลวไฟ", correct: false },
      { text: "เก็บในที่ร้อนจัด", correct: false },
    ],
    explanation: "การเก็บในที่แห้งช่วยป้องกันความเสียหายจากความชื้น",
    knowledge: "การเก็บอุปกรณ์ไฟฟ้าในที่แห้งและเย็นช่วยป้องกันสนิมและความเสียหายจากความชื้น ทำให้อุปกรณ์ใช้งานได้นาน."
  }
];

let currentIndex = 0;
let score = 0;
let startTime, endTime;

const playerNameInput = document.getElementById('playerName');
const startBtn = document.getElementById('startBtn');
const startContainer = document.getElementById('start-container');
const quizContainer = document.getElementById('quiz-container');
const questionEl = document.getElementById('question');
const answersEl = document.getElementById('answers');
const resultEl = document.getElementById('result');
const historyTable = document.getElementById('history-table');

let history = JSON.parse(localStorage.getItem('cteHomeQuizHistory')) || [];

playerNameInput.addEventListener('input', () => {
  startBtn.disabled = playerNameInput.value.trim() === '';
});

startBtn.addEventListener('click', () => {
  startContainer.style.display = 'none';
  quizContainer.style.display = 'block';
  currentIndex = 0;
  score = 0;
  startTime = new Date();
  showQuestion();
});

function showQuestion() {
  clearState();
  const currentQuiz = quizData[currentIndex];
  questionEl.textContent = `ข้อที่ ${currentIndex + 1}: ${currentQuiz.question}`;

  currentQuiz.answers.forEach((answer, i) => {
    const button = document.createElement('button');
    button.textContent = answer.text;
    button.addEventListener('click', () => selectAnswer(answer));
    answersEl.appendChild(button);
  });
}

function clearState() {
  answersEl.innerHTML = '';
  resultEl.style.display = 'none';
}

function selectAnswer(answer) {
  if (answer.correct) score++;
  showExplanation(answer.correct);
}

function showExplanation(isCorrect) {
  const currentQuiz = quizData[currentIndex];
  quizContainer.style.display = 'none';

  resultEl.innerHTML = `
    <div class="score">${isCorrect ? 'ตอบถูก!' : 'ตอบผิด!'}</div>
    <div class="explanation">เฉลย: ${currentQuiz.explanation}</div>
    <div class="knowledge">${currentQuiz.knowledge}</div>
    <button id="nextBtn">ข้อถัดไป</button>
  `;
  resultEl.style.display = 'block';

  document.getElementById('nextBtn').addEventListener('click', () => {
    currentIndex++;
    if (currentIndex < quizData.length) {
      resultEl.style.display = 'none';
      quizContainer.style.display = 'block';
      showQuestion();
    } else {
      endGame();
    }
  });
}

function endGame() {
  endTime = new Date();
  const duration = Math.floor((endTime - startTime) / 1000);

  const playerName = playerNameInput.value.trim();
  const dateStr = endTime.toLocaleDateString('th-TH');
  const timeStr = endTime.toLocaleTimeString('th-TH');

  history.push({
    name: playerName,
    score: score,
    total: quizData.length,
    date: dateStr,
    time: timeStr,
    duration: duration
  });

  localStorage.setItem('cteHomeQuizHistory', JSON.stringify(history));

  resultEl.innerHTML = `
    <h2 style="color:#004080; text-align:center;">จบเกม</h2>
    <p class="score">คะแนนของคุณ: ${score} / ${quizData.length}</p>
    <p class="score">เวลาเล่น: ${duration} วินาที</p>
    <button id="restartBtn">เริ่มใหม่</button>
  `;
  document.getElementById('restartBtn').addEventListener('click', restartGame);

  loadHistory();
}

function loadHistory() {
  if (history.length === 0) {
    historyTable.innerHTML = '<p style="text-align:center; color:#666;">ยังไม่มีผู้เล่น</p>';
    return;
  }
  let tableHTML = `<table>
    <thead>
      <tr>
        <th>ลำดับ</th>
        <th>ชื่อผู้เล่น</th>
        <th>คะแนน</th>
        <th>วันที่</th>
        <th>เวลา</th>
        <th>เวลาเล่น (วินาที)</th>
      </tr>
    </thead><tbody>`;
  history.slice().reverse().forEach((rec, i) => {
    tableHTML += `<tr>
      <td>${i + 1}</td>
      <td>${rec.name}</td>
      <td>${rec.score} / ${rec.total}</td>
      <td>${rec.date}</td>
      <td>${rec.time}</td>
      <td>${rec.duration}</td>
    </tr>`;
  });
  tableHTML += '</tbody></table>';
  historyTable.innerHTML = tableHTML;
}

function restartGame() {
  resultEl.style.display = 'none';
  startContainer.style.display = 'block';
  playerNameInput.value = '';
  startBtn.disabled = true;
  loadHistory();
}

loadHistory();
</script>

</body>
</html>
